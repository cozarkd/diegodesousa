---
phase: 05-react-19-postcss-upgrade
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - pnpm-lock.yaml
  - astro.config.mjs
autonomous: true

must_haves:
  truths:
    - "React 19.x and react-dom 19.x are installed with matching @types/react v19 and @types/react-dom v19"
    - "Radix UI packages resolve without peer dependency conflicts against React 19"
    - "@astrojs/react integration is configured in astro.config.mjs"
    - "Production build succeeds with zero errors"
  artifacts:
    - path: "package.json"
      provides: "React 19 + types dependencies"
      contains: "react.*19"
    - path: "astro.config.mjs"
      provides: "React integration in Astro config"
      contains: "@astrojs/react"
  key_links:
    - from: "package.json"
      to: "astro.config.mjs"
      via: "@astrojs/react integration registered"
      pattern: "import react from.*@astrojs/react"
    - from: "package.json"
      to: "node_modules"
      via: "pnpm install resolves all peer dependencies"
      pattern: "react.*19"
---

<objective>
Upgrade React from 18.2 to 19.2.4+, upgrade type definitions to v19, verify Radix UI peer dependency compatibility, and configure @astrojs/react integration in astro.config.mjs.

Purpose: Complete REACT-01, REACT-02, and REACT-03 requirements. React 19.2.4 includes security fix for CVE-2025-55182. Radix UI packages in package.json are already React 19 compatible (verified in research). No React component files (.tsx/.jsx) exist in the codebase, so this is purely a dependency + config upgrade.

Output: Updated package.json with React 19, configured astro.config.mjs with @astrojs/react integration, verified build.
</objective>

<execution_context>
@/Users/mini/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mini/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-react-19-postcss-upgrade/05-RESEARCH.md
@astro.config.mjs
@package.json
@tsconfig.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade React 19 + types and verify Radix UI compatibility</name>
  <files>package.json, pnpm-lock.yaml</files>
  <action>
Upgrade React, ReactDOM, and their type definitions to v19 simultaneously using pnpm:

```bash
pnpm add react@^19.2.4 react-dom@^19.2.4 @types/react@^19.2.13 @types/react-dom@^19.2.13
```

Use `pnpm add` (not `--save-exact`) to match existing package.json caret convention.

After install, verify Radix UI peer dependency resolution:

```bash
pnpm list @radix-ui/react-dialog @radix-ui/react-dropdown-menu @radix-ui/react-label @radix-ui/react-slot
```

Confirm no WARN or ERR about peer dependency conflicts with React 19. The current Radix UI versions (@radix-ui/react-dialog@^1.1.15, @radix-ui/react-dropdown-menu@^2.1.16, @radix-ui/react-label@^2.1.8, @radix-ui/react-slot@^1.2.4) are already React 19 compatible per research.

Also verify @radix-ui/react-compose-refs is 1.1.1+ (the version that fixed infinite loops with React 19):

```bash
pnpm list @radix-ui/react-compose-refs
```

IMPORTANT: Do NOT run codemods (react-codemod, types-react-codemod). There are zero .tsx/.jsx files in the codebase - codemods have nothing to transform.
  </action>
  <verify>
1. `pnpm list react react-dom @types/react @types/react-dom` shows all v19.x versions
2. `pnpm list @radix-ui/react-compose-refs` shows 1.1.1+
3. `pnpm install` exits with 0 status (no unresolved peer deps)
  </verify>
  <done>package.json shows react@^19.x, react-dom@^19.x, @types/react@^19.x, @types/react-dom@^19.x. All Radix UI packages resolve cleanly against React 19.</done>
</task>

<task type="auto">
  <name>Task 2: Configure @astrojs/react integration and verify build</name>
  <files>astro.config.mjs</files>
  <action>
Add @astrojs/react integration to astro.config.mjs. The package is already installed (^4.4.2 in package.json) but NOT configured in the integrations array.

Edit astro.config.mjs to:
1. Add import: `import react from '@astrojs/react';`
2. Add `react()` to the integrations array (place before mdx since MDX may use React components)

The updated integrations array should be:
```js
integrations: [react(), mdx(), sitemap({...}), robotsTxt(robotsConfig)]
```

Do NOT use `npx astro add react` as it may make unwanted changes. Manually edit the config file.

After editing, run a full production build to verify everything works:

```bash
pnpm run build
```

The build must succeed with zero errors. Since there are no .tsx/.jsx files, the React integration simply enables future React island support without affecting current Astro components.

Also run type checking:

```bash
npx astro check
```

Type checking should pass (may have pre-existing warnings from earlier phases - that is acceptable).
  </action>
  <verify>
1. `grep -c "@astrojs/react" astro.config.mjs` returns non-zero (import present)
2. `pnpm run build` exits with 0 status
3. `npx astro check` completes without errors (warnings acceptable)
  </verify>
  <done>astro.config.mjs has @astrojs/react integration configured. Production build succeeds. Type checking passes. Site functions identically to before the upgrade.</done>
</task>

</tasks>

<verification>
1. `pnpm list react react-dom` shows 19.x versions
2. `pnpm list @types/react @types/react-dom` shows 19.x versions
3. `pnpm list @radix-ui/react-compose-refs` shows 1.1.1+
4. `grep "react" astro.config.mjs` shows import and integration
5. `pnpm run build` succeeds (exit code 0)
6. No .tsx/.jsx files exist (confirming no component migration needed)
</verification>

<success_criteria>
- REACT-01: React 19.x and react-dom 19.x installed with @types/react v19 and @types/react-dom v19
- REACT-02: Radix UI packages resolve without peer dependency conflicts (compose-refs 1.1.1+)
- REACT-03: No errors in build output (no infinite loops possible since no React components exist; integration configured for future use)
- Production build succeeds with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-react-19-postcss-upgrade/05-01-SUMMARY.md`
</output>
